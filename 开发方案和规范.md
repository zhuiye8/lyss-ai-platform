# Lyss AI Platform å¼€å‘æ–¹æ¡ˆå’Œè§„èŒƒæ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: Lyss AI Platform  
**é¡¹ç›®å®šä½**: ä¼ä¸šçº§AIæœåŠ¡èšåˆä¸ç®¡ç†å¹³å°  
**æŠ€æœ¯æ¶æ„**: å¾®æœåŠ¡æ¶æ„ + å¤šç§Ÿæˆ·SaaSæ¨¡å¼  
**å¼€å‘è¯­è¨€**: Python (FastAPI), Go (EINO), TypeScript (React)  

## ğŸ¯ å¼€å‘æˆ˜ç•¥å’Œä¼˜å…ˆçº§

### ç¬¬ä¸€é˜¶æ®µï¼šæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ (2-3å‘¨)
**ç›®æ ‡**: å®ç°å¹³å°çš„åŸºç¡€åŠŸèƒ½ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨AIå¯¹è¯æœåŠ¡

#### 1.1 å¯¹è¯ç®¡ç†ç³»ç»Ÿ (ä¼˜å…ˆçº§: HIGH)
**å¼€å‘æ—¶é—´**: 1å‘¨  
**è´Ÿè´£æ¨¡å—**: Backend  
**æ ¸å¿ƒåŠŸèƒ½**:
- å¯¹è¯CRUDæ“ä½œ (åˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤)
- æ¶ˆæ¯ç®¡ç†å’ŒæŒä¹…åŒ–å­˜å‚¨
- å¯¹è¯æœç´¢å’Œåˆ†é¡µåŠŸèƒ½
- å¯¹è¯å¯¼å‡ºå’Œå½’æ¡£åŠŸèƒ½
- å¯¹è¯æƒé™æ§åˆ¶å’Œå…±äº«

**æŠ€æœ¯è¦æ±‚**:
- ä½¿ç”¨FastAPIæ„å»ºRESTful API
- PostgreSQLå­˜å‚¨å¯¹è¯å’Œæ¶ˆæ¯æ•°æ®
- Redisç¼“å­˜çƒ­ç‚¹å¯¹è¯æ•°æ®
- æ”¯æŒæµå¼å“åº”å’ŒWebSocketå®æ—¶é€šä¿¡

#### 1.2 AIæœåŠ¡é›†æˆå±‚ (ä¼˜å…ˆçº§: HIGH)
**å¼€å‘æ—¶é—´**: 1.5å‘¨  
**è´Ÿè´£æ¨¡å—**: Backend  
**æ ¸å¿ƒåŠŸèƒ½**:
- å¤šAIä¾›åº”å•†ç»Ÿä¸€æŠ½è±¡å±‚ (OpenAIã€Anthropicã€Googleç­‰)
- æ¨¡å‹é…ç½®å’Œç®¡ç†ç³»ç»Ÿ
- æµå¼å“åº”å¤„ç†å’Œè½¬æ¢
- æˆæœ¬è®¡ç®—å’Œä½¿ç”¨é™é¢ç®¡ç†
- ä¾›åº”å•†è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»

**æŠ€æœ¯è¦æ±‚**:
- é‡‡ç”¨ç­–ç•¥æ¨¡å¼å®ç°ä¾›åº”å•†æŠ½è±¡
- æ”¯æŒå¼‚æ­¥HTTPè¯·æ±‚å¤„ç†
- å®ç°ç†”æ–­å™¨å’Œé‡è¯•æœºåˆ¶
- é›†æˆæˆæœ¬è®¡ç®—å’Œç›‘æ§

#### 1.3 åŸºç¡€å‰ç«¯ç•Œé¢ (ä¼˜å…ˆçº§: HIGH)
**å¼€å‘æ—¶é—´**: 1å‘¨  
**è´Ÿè´£æ¨¡å—**: Frontend  
**æ ¸å¿ƒåŠŸèƒ½**:
- ç”¨æˆ·ç™»å½•å’Œæ³¨å†Œé¡µé¢
- åŸºç¡€å¯¹è¯ç•Œé¢ (èŠå¤©çª—å£ã€æ¶ˆæ¯åˆ—è¡¨)
- ç®€å•çš„ç”¨æˆ·è®¾ç½®é¡µé¢
- åŸºæœ¬çš„ç§Ÿæˆ·ç®¡ç†ç•Œé¢

**æŠ€æœ¯è¦æ±‚**:
- ä½¿ç”¨React + TypeScriptå¼€å‘
- é‡‡ç”¨Ant Design + Ant Design X UIç»„ä»¶
- å®ç°å“åº”å¼è®¾è®¡
- é›†æˆJWTè®¤è¯

### ç¬¬äºŒé˜¶æ®µï¼šå¢å¼ºåŠŸèƒ½ (2-3å‘¨)
**ç›®æ ‡**: å®Œå–„å¹³å°çš„é«˜çº§åŠŸèƒ½ï¼Œæå‡ç”¨æˆ·ä½“éªŒ

#### 2.1 MemoryæœåŠ¡å®Œå–„ (ä¼˜å…ˆçº§: MEDIUM)
**å¼€å‘æ—¶é—´**: 1.5å‘¨  
**è´Ÿè´£æ¨¡å—**: Memory Service  
**æ ¸å¿ƒåŠŸèƒ½**:
- åŸºäºMem0AIçš„æ™ºèƒ½è®°å¿†ç®¡ç†
- å‘é‡æœç´¢å’Œè¯­ä¹‰ç›¸ä¼¼åº¦åŒ¹é…
- è®°å¿†åˆ†ç±»ã€æ ‡ç­¾å’Œæƒé‡ç®¡ç†
- è®°å¿†è¿‡æœŸå’Œæ¸…ç†æœºåˆ¶

#### 2.2 EINOå·¥ä½œæµæœåŠ¡ (ä¼˜å…ˆçº§: MEDIUM)
**å¼€å‘æ—¶é—´**: 1.5å‘¨  
**è´Ÿè´£æ¨¡å—**: EINO Service  
**æ ¸å¿ƒåŠŸèƒ½**:
- OptimizedRAGå·¥ä½œæµå®ç°
- å·¥å…·è°ƒç”¨å’Œå‡½æ•°é›†æˆ
- å·¥ä½œæµç¼–æ’å’Œè°ƒåº¦å¼•æ“
- å·¥ä½œæµç›‘æ§å’Œæ—¥å¿—

#### 2.3 ç®¡ç†åå°åŠŸèƒ½ (ä¼˜å…ˆçº§: MEDIUM)
**å¼€å‘æ—¶é—´**: 1å‘¨  
**è´Ÿè´£æ¨¡å—**: Frontend + Backend  
**æ ¸å¿ƒåŠŸèƒ½**:
- ç§Ÿæˆ·ç®¡ç†å’Œé…ç½®ç•Œé¢
- ç”¨æˆ·ç®¡ç†å’Œæƒé™åˆ†é…
- ä½¿ç”¨ç»Ÿè®¡å’Œåˆ†ææŠ¥è¡¨
- ç³»ç»Ÿç›‘æ§å’Œå‘Šè­¦

### ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§ä¼ä¸šåŠŸèƒ½ (2-3å‘¨)
**ç›®æ ‡**: å®ç°ä¼ä¸šçº§é«˜çº§åŠŸèƒ½ï¼Œæ»¡è¶³å¤§å®¢æˆ·éœ€æ±‚

#### 3.1 é«˜çº§ä¼ä¸šåŠŸèƒ½
- å®¡è®¡æ—¥å¿—å¯è§†åŒ–å’Œåˆ†æ
- é«˜çº§åˆ†æå’Œè‡ªå®šä¹‰æŠ¥è¡¨
- SSOå•ç‚¹ç™»å½•é›†æˆ
- Webhookå’ŒAPIé›†æˆ
- æ•°æ®å¯¼å‡ºå’Œå¤‡ä»½åŠŸèƒ½

## ğŸ“ å¼€å‘è§„èŒƒå’Œæ ‡å‡†

### ä»£ç è§„èŒƒ

#### Pythonä»£ç è§„èŒƒ (Backend)
```python
# æ–‡ä»¶å¤´éƒ¨æ³¨é‡Šæ¨¡æ¿
"""
Lyss AI Platform - æ¨¡å—åç§°
åŠŸèƒ½æè¿°: è¯¦ç»†æè¿°æ¨¡å—åŠŸèƒ½
ä½œè€…: å¼€å‘è€…å§“å
åˆ›å»ºæ—¶é—´: 2025-07-09
æœ€åæ›´æ–°: 2025-07-09
"""

# å¯¼å…¥é¡ºåº
import os
import sys
from datetime import datetime
from typing import List, Dict, Optional

from fastapi import FastAPI, HTTPException
from sqlalchemy import select

from common.database import get_async_session
from common.models import User, Conversation

# ç±»å®šä¹‰è§„èŒƒ
class ConversationService:
    """å¯¹è¯æœåŠ¡ç±»
    
    è´Ÿè´£å¤„ç†å¯¹è¯ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œ
    """
    
    def __init__(self, db_session):
        """åˆå§‹åŒ–å¯¹è¯æœåŠ¡
        
        Args:
            db_session: æ•°æ®åº“ä¼šè¯å¯¹è±¡
        """
        self.db_session = db_session
    
    async def create_conversation(self, user_id: str, title: str) -> Conversation:
        """åˆ›å»ºæ–°å¯¹è¯
        
        Args:
            user_id: ç”¨æˆ·ID
            title: å¯¹è¯æ ‡é¢˜
            
        Returns:
            Conversation: åˆ›å»ºçš„å¯¹è¯å¯¹è±¡
            
        Raises:
            ValueError: å½“å‚æ•°æ— æ•ˆæ—¶æŠ›å‡º
        """
        # å®ç°é€»è¾‘
        pass

# å‡½æ•°å®šä¹‰è§„èŒƒ
async def get_conversation_by_id(conversation_id: str) -> Optional[Conversation]:
    """æ ¹æ®IDè·å–å¯¹è¯
    
    Args:
        conversation_id: å¯¹è¯ID
        
    Returns:
        Optional[Conversation]: å¯¹è¯å¯¹è±¡ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›None
    """
    # å®ç°é€»è¾‘
    pass

# å¸¸é‡å®šä¹‰
DEFAULT_PAGE_SIZE = 20
MAX_PAGE_SIZE = 100
DEFAULT_CONVERSATION_TITLE = "æ–°å¯¹è¯"

# é”™è¯¯å¤„ç†è§„èŒƒ
try:
    result = await some_async_operation()
except ValueError as e:
    logger.error(f"å‚æ•°é”™è¯¯: {e}")
    raise HTTPException(status_code=400, detail=f"å‚æ•°é”™è¯¯: {e}")
except Exception as e:
    logger.error(f"æœªçŸ¥é”™è¯¯: {e}")
    raise HTTPException(status_code=500, detail="å†…éƒ¨æœåŠ¡å™¨é”™è¯¯")
```

#### Goä»£ç è§„èŒƒ (EINO Service)
```go
// æ–‡ä»¶å¤´éƒ¨æ³¨é‡Šæ¨¡æ¿
/*
Lyss AI Platform - EINOæœåŠ¡
åŠŸèƒ½æè¿°: AIå·¥ä½œæµç¼–æ’å’Œç®¡ç†
ä½œè€…: å¼€å‘è€…å§“å
åˆ›å»ºæ—¶é—´: 2025-07-09
æœ€åæ›´æ–°: 2025-07-09
*/

package services

import (
    "context"
    "fmt"
    "time"

    "github.com/cloudwego/eino"
    "github.com/google/uuid"
)

// å¸¸é‡å®šä¹‰
const (
    DefaultTimeout = 30 * time.Second
    MaxRetries     = 3
    DefaultModel   = "gpt-4"
)

// ç»“æ„ä½“å®šä¹‰
type WorkflowService struct {
    client eino.Client
    config *WorkflowConfig
}

// WorkflowConfig å·¥ä½œæµé…ç½®
type WorkflowConfig struct {
    Model       string        `json:"model"`
    Temperature float64       `json:"temperature"`
    MaxTokens   int           `json:"max_tokens"`
    Timeout     time.Duration `json:"timeout"`
}

// NewWorkflowService åˆ›å»ºå·¥ä½œæµæœåŠ¡å®ä¾‹
func NewWorkflowService(client eino.Client, config *WorkflowConfig) *WorkflowService {
    return &WorkflowService{
        client: client,
        config: config,
    }
}

// ProcessConversation å¤„ç†å¯¹è¯å·¥ä½œæµ
func (s *WorkflowService) ProcessConversation(ctx context.Context, req *ConversationRequest) (*ConversationResponse, error) {
    // å‚æ•°éªŒè¯
    if req == nil {
        return nil, fmt.Errorf("è¯·æ±‚å‚æ•°ä¸èƒ½ä¸ºç©º")
    }
    
    if req.ConversationID == "" {
        return nil, fmt.Errorf("å¯¹è¯IDä¸èƒ½ä¸ºç©º")
    }
    
    // ä¸šåŠ¡é€»è¾‘å®ç°
    response, err := s.processWorkflow(ctx, req)
    if err != nil {
        return nil, fmt.Errorf("å¤„ç†å·¥ä½œæµå¤±è´¥: %w", err)
    }
    
    return response, nil
}

// ç§æœ‰æ–¹æ³•ä½¿ç”¨å°å†™å¼€å¤´
func (s *WorkflowService) processWorkflow(ctx context.Context, req *ConversationRequest) (*ConversationResponse, error) {
    // å®ç°é€»è¾‘
    return nil, nil
}
```

#### TypeScriptä»£ç è§„èŒƒ (Frontend)
```typescript
/**
 * Lyss AI Platform - å‰ç«¯ç»„ä»¶
 * åŠŸèƒ½æè¿°: å¯¹è¯ç•Œé¢ç»„ä»¶
 * ä½œè€…: å¼€å‘è€…å§“å
 * åˆ›å»ºæ—¶é—´: 2025-07-09
 * æœ€åæ›´æ–°: 2025-07-09
 */

import React, { useState, useEffect, useCallback } from 'react';
import { Button, Input, List, message } from 'antd';
import { SendOutlined, DeleteOutlined } from '@ant-design/icons';
import { useAuth } from '@/hooks/useAuth';
import { conversationService } from '@/services/conversationService';
import type { Conversation, Message } from '@/types';

// æ¥å£å®šä¹‰
interface ConversationComponentProps {
  conversationId: string;
  onMessageSent?: (message: Message) => void;
  className?: string;
}

// å¸¸é‡å®šä¹‰
const DEFAULT_PAGE_SIZE = 20;
const MAX_MESSAGE_LENGTH = 2000;

// ç»„ä»¶å®šä¹‰
const ConversationComponent: React.FC<ConversationComponentProps> = ({
  conversationId,
  onMessageSent,
  className,
}) => {
  // çŠ¶æ€å®šä¹‰
  const [messages, setMessages] = useState<Message[]>([]);
  const [inputValue, setInputValue] = useState('');
  const [loading, setLoading] = useState(false);
  const [conversation, setConversation] = useState<Conversation | null>(null);
  
  // é’©å­ä½¿ç”¨
  const { user } = useAuth();
  
  // å‰¯ä½œç”¨å¤„ç†
  useEffect(() => {
    if (conversationId) {
      loadConversation();
      loadMessages();
    }
  }, [conversationId]);
  
  // å›è°ƒå‡½æ•°å®šä¹‰
  const loadConversation = useCallback(async () => {
    try {
      const conv = await conversationService.getById(conversationId);
      setConversation(conv);
    } catch (error) {
      message.error('åŠ è½½å¯¹è¯å¤±è´¥');
      console.error('åŠ è½½å¯¹è¯é”™è¯¯:', error);
    }
  }, [conversationId]);
  
  const loadMessages = useCallback(async () => {
    try {
      setLoading(true);
      const msgs = await conversationService.getMessages(conversationId);
      setMessages(msgs);
    } catch (error) {
      message.error('åŠ è½½æ¶ˆæ¯å¤±è´¥');
      console.error('åŠ è½½æ¶ˆæ¯é”™è¯¯:', error);
    } finally {
      setLoading(false);
    }
  }, [conversationId]);
  
  const handleSendMessage = useCallback(async () => {
    if (!inputValue.trim()) {
      message.warning('è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹');
      return;
    }
    
    if (inputValue.length > MAX_MESSAGE_LENGTH) {
      message.error(`æ¶ˆæ¯é•¿åº¦ä¸èƒ½è¶…è¿‡ ${MAX_MESSAGE_LENGTH} ä¸ªå­—ç¬¦`);
      return;
    }
    
    try {
      setLoading(true);
      const newMessage = await conversationService.sendMessage(
        conversationId,
        inputValue.trim()
      );
      
      setMessages(prev => [...prev, newMessage]);
      setInputValue('');
      onMessageSent?.(newMessage);
      
      message.success('æ¶ˆæ¯å‘é€æˆåŠŸ');
    } catch (error) {
      message.error('å‘é€æ¶ˆæ¯å¤±è´¥');
      console.error('å‘é€æ¶ˆæ¯é”™è¯¯:', error);
    } finally {
      setLoading(false);
    }
  }, [conversationId, inputValue, onMessageSent]);
  
  // æ¸²æŸ“å‡½æ•°
  return (
    <div className={`conversation-component ${className || ''}`}>
      <div className="conversation-header">
        <h3>{conversation?.title || 'å¯¹è¯'}</h3>
      </div>
      
      <div className="messages-container">
        <List
          loading={loading}
          dataSource={messages}
          renderItem={(message) => (
            <List.Item key={message.id}>
              <div className={`message ${message.role}`}>
                <div className="message-content">{message.content}</div>
                <div className="message-time">
                  {new Date(message.createdAt).toLocaleString()}
                </div>
              </div>
            </List.Item>
          )}
        />
      </div>
      
      <div className="input-container">
        <Input.TextArea
          value={inputValue}
          onChange={(e) => setInputValue(e.target.value)}
          placeholder="è¯·è¾“å…¥æ¶ˆæ¯..."
          rows={3}
          maxLength={MAX_MESSAGE_LENGTH}
          onPressEnter={(e) => {
            if (e.shiftKey) return;
            e.preventDefault();
            handleSendMessage();
          }}
        />
        <Button
          type="primary"
          icon={<SendOutlined />}
          onClick={handleSendMessage}
          loading={loading}
          disabled={!inputValue.trim()}
        >
          å‘é€
        </Button>
      </div>
    </div>
  );
};

export default ConversationComponent;
```

### APIå“åº”è§„èŒƒ

#### ç»Ÿä¸€å“åº”æ ¼å¼
```json
{
  "success": true,
  "data": {},
  "message": "æ“ä½œæˆåŠŸ",
  "request_id": "550e8400-e29b-41d4-a716-446655440000",
  "timestamp": "2025-07-09T10:30:00.000Z",
  "errors": []
}
```

#### é”™è¯¯å“åº”æ ¼å¼
```json
{
  "success": false,
  "data": null,
  "message": "æ“ä½œå¤±è´¥",
  "request_id": "550e8400-e29b-41d4-a716-446655440000",
  "timestamp": "2025-07-09T10:30:00.000Z",
  "errors": [
    {
      "code": "VALIDATION_ERROR",
      "message": "å‚æ•°éªŒè¯å¤±è´¥",
      "field": "email",
      "details": {
        "expected": "valid email format",
        "actual": "invalid-email"
      }
    }
  ]
}
```

#### åˆ†é¡µå“åº”æ ¼å¼
```json
{
  "success": true,
  "data": {
    "items": [...],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total_count": 100,
      "total_pages": 5,
      "has_next": true,
      "has_previous": false
    }
  },
  "message": "è·å–æ•°æ®æˆåŠŸ"
}
```

### æ•°æ®åº“è§„èŒƒ

#### è¡¨å‘½åè§„èŒƒ
- ä½¿ç”¨å¤æ•°å½¢å¼: `users`, `conversations`, `messages`
- ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”: `user_roles`, `ai_credentials`
- é¿å…ç¼©å†™: `conversations` è€Œä¸æ˜¯ `convs`

#### å­—æ®µå‘½åè§„èŒƒ
- ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”: `user_id`, `created_at`, `updated_at`
- ä¸»é”®ç»Ÿä¸€ä½¿ç”¨ `{table_name}_id` æ ¼å¼
- æ—¶é—´æˆ³å­—æ®µ: `created_at`, `updated_at`, `deleted_at`
- å¸ƒå°”å­—æ®µä½¿ç”¨ `is_` å‰ç¼€: `is_active`, `is_deleted`

#### ç´¢å¼•è§„èŒƒ
```sql
-- å•å­—æ®µç´¢å¼•
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_conversations_user_id ON conversations(user_id);

-- å¤åˆç´¢å¼•
CREATE INDEX idx_messages_conversation_created ON messages(conversation_id, created_at);
CREATE INDEX idx_users_tenant_status ON users(tenant_id, status);

-- å”¯ä¸€çº¦æŸ
CREATE UNIQUE INDEX idx_users_email_unique ON users(email);
CREATE UNIQUE INDEX idx_tenants_slug_unique ON tenants(tenant_slug);
```

### æ—¥å¿—è§„èŒƒ

#### æ—¥å¿—çº§åˆ«
- `DEBUG`: è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
- `INFO`: ä¸€èˆ¬ä¿¡æ¯è®°å½•
- `WARNING`: è­¦å‘Šä¿¡æ¯
- `ERROR`: é”™è¯¯ä¿¡æ¯
- `CRITICAL`: ä¸¥é‡é”™è¯¯

#### æ—¥å¿—æ ¼å¼
```python
import logging
import structlog

# é…ç½®ç»“æ„åŒ–æ—¥å¿—
structlog.configure(
    processors=[
        structlog.processors.TimeStamper(fmt="iso"),
        structlog.processors.add_log_level,
        structlog.processors.JSONRenderer()
    ],
    wrapper_class=structlog.make_filtering_bound_logger(logging.INFO),
    logger_factory=structlog.WriteLoggerFactory(),
    cache_logger_on_first_use=True,
)

logger = structlog.get_logger()

# ä½¿ç”¨ç¤ºä¾‹
logger.info("ç”¨æˆ·ç™»å½•æˆåŠŸ", user_id=user_id, tenant_id=tenant_id, ip_address=ip)
logger.error("æ•°æ®åº“è¿æ¥å¤±è´¥", error=str(e), database_url=db_url)
logger.warning("APIè°ƒç”¨é¢‘ç‡è¿‡é«˜", user_id=user_id, current_rate=rate, limit=limit)
```

## ğŸ”§ å¼€å‘å·¥å…·å’Œç¯å¢ƒ

### å¼€å‘ç¯å¢ƒé…ç½®

#### Pythonç¯å¢ƒ
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# ä»£ç æ ¼å¼åŒ–
black . --line-length 88
isort .

# ç±»å‹æ£€æŸ¥
mypy .

# æµ‹è¯•
pytest tests/ --cov=. --cov-report=html
```

#### Goç¯å¢ƒ
```bash
# åˆå§‹åŒ–Goæ¨¡å—
go mod init github.com/lyss-ai/eino-service

# å®‰è£…ä¾èµ–
go mod download

# ä»£ç æ ¼å¼åŒ–
go fmt ./...

# ä»£ç æ£€æŸ¥
golangci-lint run

# æµ‹è¯•
go test ./... -v -race -coverprofile=coverage.out
```

#### Node.jsç¯å¢ƒ
```bash
# å®‰è£…ä¾èµ–
npm install

# ä»£ç æ ¼å¼åŒ–
npm run format

# ç±»å‹æ£€æŸ¥
npm run type-check

# æµ‹è¯•
npm run test

# æ„å»º
npm run build
```

### Gitè§„èŒƒ

#### æäº¤ä¿¡æ¯æ ¼å¼
```
<type>(<scope>): <subject>

<body>

<footer>
```

#### ç±»å‹è¯´æ˜
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´
- `refactor`: é‡æ„ä»£ç 
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»º/å·¥å…·ç›¸å…³

#### æäº¤ç¤ºä¾‹
```
feat(auth): æ·»åŠ JWTä»¤ç‰Œåˆ·æ–°åŠŸèƒ½

- å®ç°åˆ·æ–°ä»¤ç‰Œçš„ç”Ÿæˆå’ŒéªŒè¯
- æ·»åŠ ä»¤ç‰Œè¿‡æœŸæ—¶é—´é…ç½®
- æ›´æ–°è®¤è¯ä¸­é—´ä»¶æ”¯æŒä»¤ç‰Œåˆ·æ–°

Closes #123
```

### æµ‹è¯•è§„èŒƒ

#### å•å…ƒæµ‹è¯•
```python
# Pythonæµ‹è¯•ç¤ºä¾‹
import pytest
from unittest.mock import Mock, patch
from fastapi.testclient import TestClient

from main import app
from services.conversation_service import ConversationService

client = TestClient(app)

class TestConversationService:
    """å¯¹è¯æœåŠ¡æµ‹è¯•ç±»"""
    
    def test_create_conversation_success(self):
        """æµ‹è¯•åˆ›å»ºå¯¹è¯æˆåŠŸ"""
        # å‡†å¤‡æµ‹è¯•æ•°æ®
        user_id = "test-user-id"
        title = "æµ‹è¯•å¯¹è¯"
        
        # æ¨¡æ‹Ÿä¾èµ–
        with patch('services.conversation_service.get_async_session') as mock_session:
            mock_session.return_value = Mock()
            
            # æ‰§è¡Œæµ‹è¯•
            service = ConversationService(mock_session.return_value)
            result = service.create_conversation(user_id, title)
            
            # éªŒè¯ç»“æœ
            assert result is not None
            assert result.title == title
            assert result.user_id == user_id
    
    def test_create_conversation_invalid_params(self):
        """æµ‹è¯•åˆ›å»ºå¯¹è¯å‚æ•°æ— æ•ˆ"""
        service = ConversationService(Mock())
        
        # æµ‹è¯•ç©ºç”¨æˆ·ID
        with pytest.raises(ValueError, match="ç”¨æˆ·IDä¸èƒ½ä¸ºç©º"):
            service.create_conversation("", "æµ‹è¯•å¯¹è¯")
        
        # æµ‹è¯•ç©ºæ ‡é¢˜
        with pytest.raises(ValueError, match="æ ‡é¢˜ä¸èƒ½ä¸ºç©º"):
            service.create_conversation("user-id", "")
```

#### é›†æˆæµ‹è¯•
```python
# é›†æˆæµ‹è¯•ç¤ºä¾‹
def test_conversation_api_flow():
    """æµ‹è¯•å¯¹è¯APIå®Œæ•´æµç¨‹"""
    # 1. ç”¨æˆ·ç™»å½•
    login_response = client.post("/api/v1/auth/login", json={
        "email": "test@example.com",
        "password": "password123"
    })
    assert login_response.status_code == 200
    
    token = login_response.json()["data"]["access_token"]
    headers = {"Authorization": f"Bearer {token}"}
    
    # 2. åˆ›å»ºå¯¹è¯
    create_response = client.post("/api/v1/conversations", 
        json={"title": "æµ‹è¯•å¯¹è¯"}, 
        headers=headers
    )
    assert create_response.status_code == 201
    
    conversation_id = create_response.json()["data"]["conversation_id"]
    
    # 3. å‘é€æ¶ˆæ¯
    message_response = client.post(f"/api/v1/conversations/{conversation_id}/messages",
        json={"content": "ä½ å¥½", "role": "user"},
        headers=headers
    )
    assert message_response.status_code == 201
    
    # 4. è·å–æ¶ˆæ¯åˆ—è¡¨
    messages_response = client.get(f"/api/v1/conversations/{conversation_id}/messages",
        headers=headers
    )
    assert messages_response.status_code == 200
    assert len(messages_response.json()["data"]["messages"]) > 0
```

## ğŸ“Š æ€§èƒ½å’Œç›‘æ§

### æ€§èƒ½æŒ‡æ ‡
- APIå“åº”æ—¶é—´ < 500ms (P95)
- æ•°æ®åº“æŸ¥è¯¢æ—¶é—´ < 100ms (P95)
- ç³»ç»Ÿå†…å­˜ä½¿ç”¨ç‡ < 80%
- CPUä½¿ç”¨ç‡ < 70%
- é”™è¯¯ç‡ < 1%

### ç›‘æ§é…ç½®
```python
# PrometheusæŒ‡æ ‡é…ç½®
from prometheus_client import Counter, Histogram, Gauge

# å®šä¹‰æŒ‡æ ‡
REQUEST_COUNT = Counter('http_requests_total', 'Total HTTP requests', ['method', 'endpoint', 'status'])
REQUEST_DURATION = Histogram('http_request_duration_seconds', 'HTTP request duration')
ACTIVE_CONNECTIONS = Gauge('active_connections', 'Number of active connections')

# ä½¿ç”¨ç¤ºä¾‹
@REQUEST_DURATION.time()
async def process_request():
    REQUEST_COUNT.labels(method='POST', endpoint='/api/v1/conversations', status='200').inc()
    # å¤„ç†è¯·æ±‚é€»è¾‘
```

### å‘Šè­¦è§„åˆ™
```yaml
# Prometheuså‘Šè­¦è§„åˆ™
groups:
  - name: lyss-ai-platform
    rules:
      - alert: HighErrorRate
        expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.01
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "é«˜é”™è¯¯ç‡å‘Šè­¦"
          description: "é”™è¯¯ç‡è¶…è¿‡1%"
      
      - alert: HighResponseTime
        expr: histogram_quantile(0.95, http_request_duration_seconds) > 0.5
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "å“åº”æ—¶é—´è¿‡é•¿"
          description: "95%çš„è¯·æ±‚å“åº”æ—¶é—´è¶…è¿‡500ms"
```

## ğŸš€ éƒ¨ç½²å’Œè¿ç»´

### Dockeré…ç½®
```dockerfile
# PythonæœåŠ¡Dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8000

CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
```

### Docker Composeé…ç½®
```yaml
version: '3.8'

services:
  backend:
    build: ./backend
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:password@postgres:5432/lyss_db
      - REDIS_URL=redis://redis:6379/0
    depends_on:
      - postgres
      - redis
  
  postgres:
    image: pgvector/pgvector:pg16
    environment:
      - POSTGRES_DB=lyss_db
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
    volumes:
      - postgres_data:/var/lib/postgresql/data
  
  redis:
    image: redis:8.0-alpine
    command: redis-server --appendonly yes
    volumes:
      - redis_data:/data

volumes:
  postgres_data:
  redis_data:
```

### CI/CDé…ç½®
```yaml
# GitHub Actionsé…ç½®
name: CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    services:
      postgres:
        image: postgres:16
        env:
          POSTGRES_PASSWORD: postgres
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Install dependencies
        run: |
          pip install -r requirements.txt
          pip install -r requirements-dev.txt
      
      - name: Run tests
        run: |
          pytest tests/ --cov=. --cov-report=xml
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
  
  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Deploy to production
        run: |
          # éƒ¨ç½²è„šæœ¬
          echo "éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ"
```

è¿™ä¸ªå¼€å‘æ–¹æ¡ˆå’Œè§„èŒƒæ–‡æ¡£æä¾›äº†å®Œæ•´çš„å¼€å‘æŒ‡å¯¼ï¼ŒåŒ…æ‹¬ä¼˜å…ˆçº§è§„åˆ’ã€ä»£ç è§„èŒƒã€APIè®¾è®¡ã€æµ‹è¯•ç­–ç•¥ã€æ€§èƒ½ç›‘æ§å’Œéƒ¨ç½²è¿ç»´ç­‰å„ä¸ªæ–¹é¢ã€‚