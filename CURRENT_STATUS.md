# Lyss AI Platform å½“å‰å¼€å‘çŠ¶æ€æ€»ç»“

> **æœ€åæ›´æ–°**: 2025-07-13  
> **æ›´æ–°è€…**: Claude  
> **é¡¹ç›®é˜¶æ®µ**: ç¬¬ä¸€é˜¶æ®µ - æ ¸å¿ƒåŠŸèƒ½å¼€å‘å®Œå–„æœŸ

## ğŸ¯ å¿«é€ŸçŠ¶æ€æ¦‚è§ˆ

**æ•´ä½“è¿›åº¦**: æ ¸å¿ƒåç«¯æœåŠ¡80%å®Œæˆï¼ŒFrontendåŸºç¡€æ¶æ„70%å®Œæˆ  
**å½“å‰é‡ç‚¹**: è¡¥å…¨Tenant Serviceç®¡ç†APIæ¥å£ï¼Œå®ç°Frontendç®¡ç†ç•Œé¢  
**å¯è¿è¡ŒçŠ¶æ€**: âœ… ç”¨æˆ·å¯ä»¥æ­£å¸¸ç™»å½•ç³»ç»Ÿ

## ğŸ“Š å„æœåŠ¡è¯¦ç»†çŠ¶æ€

### âœ… Auth Service (è®¤è¯æœåŠ¡) - 100%å®Œæˆ
- **ç«¯å£**: 8001
- **çŠ¶æ€**: å®Œå…¨å¯ç”¨
- **æ ¸å¿ƒåŠŸèƒ½**: JWTè®¤è¯ã€ç”¨æˆ·ç™»å½•ã€ä»¤ç‰Œç®¡ç†ã€ä¼šè¯æ§åˆ¶
- **æŠ€æœ¯æ ˆ**: Python + FastAPI + JWT + Redis
- **æµ‹è¯•çŠ¶æ€**: å·²é€šè¿‡å®Œæ•´æµ‹è¯•

### âš ï¸ Tenant Service (ç§Ÿæˆ·æœåŠ¡) - 80%å®Œæˆ
- **ç«¯å£**: 8002  
- **çŠ¶æ€**: éƒ¨åˆ†å¯ç”¨
- **å·²å®Œæˆ**: 
  - âœ… å†…éƒ¨ç”¨æˆ·éªŒè¯æ¥å£ (`/internal/users/verify`)
  - âœ… ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢æ¥å£ (`/internal/users/{user_id}`)
  - âœ… æ•°æ®åº“æ¨¡å‹ã€Repositoryå±‚ã€åŠ å¯†æœºåˆ¶
  - âœ… å¥åº·æ£€æŸ¥æ¥å£
- **å¾…è¡¥å…¨**:
  - â³ ç§Ÿæˆ·ç®¡ç†API (`/api/v1/admin/tenants/*`)
  - â³ ç”¨æˆ·ç®¡ç†API (`/api/v1/admin/users/*`)  
  - â³ ä¾›åº”å•†å‡­è¯API (`/api/v1/admin/suppliers/*`)

### âœ… Backend API Gateway - 100%å®Œæˆ
- **ç«¯å£**: 8000
- **çŠ¶æ€**: å®Œå…¨å¯ç”¨  
- **æ ¸å¿ƒåŠŸèƒ½**: ç»Ÿä¸€å…¥å£ã€è·¯ç”±è½¬å‘ã€JWTè®¤è¯ã€é”™è¯¯å¤„ç†
- **æŠ€æœ¯æ ˆ**: Python + FastAPI + å¾®æœåŠ¡è°ƒç”¨
- **æµ‹è¯•çŠ¶æ€**: è®¤è¯å’Œè·¯ç”±åŠŸèƒ½å·²éªŒè¯

### âš ï¸ Frontend (å‰ç«¯åº”ç”¨) - 70%å®Œæˆ
- **ç«¯å£**: 3000
- **çŠ¶æ€**: åŸºç¡€åŠŸèƒ½å¯ç”¨
- **å·²å®Œæˆ**:
  - âœ… ç”¨æˆ·ç™»å½•ç•Œé¢(èƒ½å¤Ÿæ­£å¸¸ç™»å½•)
  - âœ… JWTè®¤è¯é›†æˆ
  - âœ… åŸºç¡€è·¯ç”±å’Œå¯¼èˆª
  - âœ… é”™è¯¯å¤„ç†å’Œä¸»é¢˜é…ç½®
- **å¾…å®ç°**:
  - â³ ç§Ÿæˆ·ç®¡ç†ç•Œé¢
  - â³ ç”¨æˆ·ç®¡ç†ç•Œé¢  
  - â³ ä¾›åº”å•†ç®¡ç†ç•Œé¢

### â³ EINO Service (AIå·¥ä½œæµ) - 0%
- **ç«¯å£**: 8003
- **çŠ¶æ€**: æœªå¼€å§‹
- **ä¾èµ–**: ç­‰å¾…Tenant Serviceå®Œæˆ

### â³ Memory Service (è®°å¿†æœåŠ¡) - 0%  
- **ç«¯å£**: 8004
- **çŠ¶æ€**: æœªå¼€å§‹
- **ä¾èµ–**: ç­‰å¾…Tenant Serviceå®Œæˆ

## ğŸ”— æ ¸å¿ƒåŠŸèƒ½éªŒè¯çŠ¶æ€

### âœ… ç”¨æˆ·è®¤è¯é“¾è·¯ - å·²æ‰“é€š
```
Frontendç™»å½• â†’ API Gateway â†’ Auth Service â†’ Tenant Service â†’ æ•°æ®åº“
```
- ç”¨æˆ·å¯ä»¥æ­£å¸¸ç™»å½•
- JWTä»¤ç‰Œæ­£å¸¸ç­¾å‘å’ŒéªŒè¯
- å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»æœºåˆ¶ç”Ÿæ•ˆ

### âš ï¸ ç®¡ç†åŠŸèƒ½é“¾è·¯ - éƒ¨åˆ†å¯ç”¨
```
Frontendç®¡ç†ç•Œé¢ â†’ API Gateway â†’ Tenant Serviceç®¡ç†API â†’ æ•°æ®åº“
```
- åç«¯ç®¡ç†APIæ¥å£ç¼ºå¤±
- å‰ç«¯ç®¡ç†ç•Œé¢æœªå®ç°

## ğŸ¯ ä¸‹ä¸€æ­¥å¼€å‘ä»»åŠ¡

### ä¼˜å…ˆçº§1: Tenant Service ç®¡ç†API (é«˜ä¼˜å…ˆçº§)
**ç›®æ ‡**: è¡¥å…¨æ‰€æœ‰ç®¡ç†APIæ¥å£ï¼Œä½¿å¹³å°å…·å¤‡å®Œæ•´çš„ç®¡ç†åŠŸèƒ½

**å…·ä½“ä»»åŠ¡**:
1. **ç§Ÿæˆ·ç®¡ç†API** (`tenant_service/routers/tenants.py`)
   - åˆ›å»ºç§Ÿæˆ·: `POST /api/v1/admin/tenants`
   - ç§Ÿæˆ·åˆ—è¡¨: `GET /api/v1/admin/tenants`
   - æ›´æ–°ç§Ÿæˆ·: `PUT /api/v1/admin/tenants/{tenant_id}`

2. **ç”¨æˆ·ç®¡ç†API** (`tenant_service/routers/users.py`)
   - ç”¨æˆ·æ³¨å†Œ: `POST /api/v1/admin/users`
   - ç”¨æˆ·åˆ—è¡¨: `GET /api/v1/admin/users`
   - æ›´æ–°ç”¨æˆ·: `PUT /api/v1/admin/users/{user_id}`

3. **ä¾›åº”å•†å‡­è¯API** (`tenant_service/routers/suppliers.py`)
   - æ·»åŠ å‡­è¯: `POST /api/v1/admin/suppliers`
   - å‡­è¯åˆ—è¡¨: `GET /api/v1/admin/suppliers`
   - æµ‹è¯•è¿æ¥: `POST /api/v1/admin/suppliers/{id}/test`

**å‚è€ƒæ–‡æ¡£**: `/home/zhuiye/work/lyss-ai-platform/docs/tenant_service.md`

### ä¼˜å…ˆçº§2: Frontend ç®¡ç†ç•Œé¢ (ä¸­ä¼˜å…ˆçº§)
**ç›®æ ‡**: å®ç°å®Œæ•´çš„ç®¡ç†ç•Œé¢ï¼Œæä¾›ç”¨æˆ·å‹å¥½çš„ç®¡ç†ä½“éªŒ

**å…·ä½“ä»»åŠ¡**:
1. **ç§Ÿæˆ·ç®¡ç†é¡µé¢** (`frontend/src/pages/admin/tenants/`)
2. **ç”¨æˆ·ç®¡ç†é¡µé¢** (`frontend/src/pages/admin/users/`)  
3. **ä¾›åº”å•†ç®¡ç†é¡µé¢** (`frontend/src/pages/admin/suppliers/`)

**å‚è€ƒæ–‡æ¡£**: `/home/zhuiye/work/lyss-ai-platform/docs/frontend.md`

## ğŸ“š å…³é”®æ–‡æ¡£æŒ‡å¼•

### å¿…è¯»æ–‡æ¡£ (æ–°ä¼šè¯å¼€å§‹å‰)
1. **`CLAUDE.md`** - é¡¹ç›®æ€»ä½“æŒ‡å¯¼å’Œå¼€å‘è§„èŒƒ
2. **`DEVELOPMENT_PRIORITY.md`** - å®Œæ•´çš„å¼€å‘ä¼˜å…ˆçº§å’Œè¿›åº¦
3. **`docs/tenant_service.md`** - Tenant Serviceå®Œæ•´è§„èŒƒ
4. **`docs/frontend.md`** - FrontendæŠ€æœ¯è§„èŒƒ
5. **`docs/PROJECT_STRUCTURE.md`** - é¡¹ç›®ç»“æ„è§„èŒƒ

### æœåŠ¡å¯åŠ¨å‘½ä»¤
```bash
# Auth Service
cd auth-service && source venv/bin/activate && uvicorn auth_service.main:app --port 8001 --reload

# Tenant Service  
cd tenant-service && source venv/bin/activate && uvicorn tenant_service.main:app --port 8002 --reload

# API Gateway
cd backend && source venv/bin/activate && uvicorn api_gateway.main:app --port 8000 --reload

# Frontend
cd frontend && npm run dev
```

## ğŸš¨ é‡è¦å‘ç°å’Œè§£å†³æ–¹æ¡ˆ

### ä¹‹å‰çš„ç™»å½•é—®é¢˜æ ¹å› 
**é—®é¢˜**: ç™»å½•æ—¶å‡ºç°500é”™è¯¯ï¼Œåæ¥æ˜¯429é™æµé”™è¯¯  
**æ ¹å› **: Tenant Serviceçš„å†…éƒ¨ç”¨æˆ·éªŒè¯æ¥å£è™½ç„¶å·²å®ç°ï¼Œä½†è·¯ç”±æ³¨å†Œæœ‰é—®é¢˜  
**è§£å†³**: å·²åœ¨`main.py`ä¸­æ­£ç¡®æ³¨å†Œ`internal.router`ï¼Œç™»å½•åŠŸèƒ½ç°åœ¨æ­£å¸¸

### æŠ€æœ¯æ¶æ„éªŒè¯
- âœ… å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»æœºåˆ¶å·¥ä½œæ­£å¸¸
- âœ… JWTè®¤è¯åœ¨æ•´ä¸ªå¾®æœåŠ¡é“¾è·¯ä¸­ä¼ é€’æ­£ç¡®
- âœ… pgcryptoåŠ å¯†å­˜å‚¨æœºåˆ¶å·²å®ç°
- âœ… æ‰€æœ‰æœåŠ¡çš„å¥åº·æ£€æŸ¥æ¥å£æ­£å¸¸
- âœ… é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•è§„èŒƒç»Ÿä¸€

## ğŸ”§ å¼€å‘ç¯å¢ƒçŠ¶æ€

### æ•°æ®åº“
- **PostgreSQL**: è¿è¡Œæ­£å¸¸ï¼Œç«¯å£5433
- **æ•°æ®åº“å**: lyss_platform  
- **æµ‹è¯•æ•°æ®**: å·²åˆå§‹åŒ–ï¼ŒåŒ…å«æµ‹è¯•ç”¨æˆ·å’Œè§’è‰²

### æœåŠ¡è¿›ç¨‹
- **Auth Service**: å¯æ­£å¸¸å¯åŠ¨å’Œè¿è¡Œ
- **Tenant Service**: å¯æ­£å¸¸å¯åŠ¨ï¼Œå†…éƒ¨æ¥å£å·¥ä½œæ­£å¸¸
- **API Gateway**: å¯æ­£å¸¸å¯åŠ¨ï¼Œè·¯ç”±è½¬å‘æ­£å¸¸
- **Frontend**: å¯æ­£å¸¸å¯åŠ¨ï¼Œç™»å½•åŠŸèƒ½éªŒè¯é€šè¿‡

### ä¸‹ä¸€ä¸ªä¼šè¯çš„é¢„æœŸæˆæœ
å®Œæˆæœ¬æ¬¡å¼€å‘åï¼Œå¹³å°å°†å…·å¤‡ï¼š
1. âœ… å®Œæ•´çš„ç”¨æˆ·è®¤è¯åŠŸèƒ½
2. âœ… å®Œæ•´çš„ç§Ÿæˆ·ç®¡ç†åŠŸèƒ½  
3. âœ… å®Œæ•´çš„ç”¨æˆ·ç®¡ç†åŠŸèƒ½
4. âœ… å®Œæ•´çš„ä¾›åº”å•†å‡­è¯ç®¡ç†åŠŸèƒ½
5. âœ… å‹å¥½çš„ç®¡ç†ç•Œé¢

è¿™å°†ä¸ºåç»­çš„EINO Serviceå’ŒMemory Serviceå¼€å‘å¥ å®šåšå®åŸºç¡€ã€‚